<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>å“‡ã„Ÿç¶²ç«™</title>
    <link rel="icon"href="icon.png">
  </head>
  <body>
 <!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ä»Šå¤©åƒä»€éº¼è½‰ç›¤</title>
  <style>
    body {
      font-family: 'Microsoft JhengHei', sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      background: #f0f2f5;
    }

    .container {
      display: flex;
      gap: 50px;
      align-items: center;
      margin-top: 30px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .wheel-outer {
      position: relative;
      width: 400px;
      height: 400px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      border-radius: 50%;
    }

    .pointer {
      width: 0;
      height: 0;
      border-left: 15px solid transparent;
      border-right: 15px solid transparent;
      border-top: 30px solid #e74c3c;
      position: absolute;
      top: -15px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 10;
      filter: drop-shadow(0 2px 2px rgba(0,0,0,0.2));
    }

    canvas {
      transition: transform 4s cubic-bezier(0.15, 0, 0.15, 1);
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background: white;
    }

    .input-box {
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      display: flex;
      flex-direction: column;
      gap: 15px;
      width: 300px;
    }

    textarea {
      height: 180px;
      padding: 12px;
      border-radius: 8px;
      border: 1px solid #ddd;
      line-height: 1.6;
      font-size: 16px;
      resize: none;
    }

    .btn-group {
      display: flex;
      gap: 10px;
    }

    button {
      flex: 1;
      padding: 12px;
      border-radius: 8px;
      border: none;
      font-weight: bold;
      font-size: 16px;
      cursor: pointer;
      transition: 0.3s;
    }

    #spinBtn { background: #007bff; color: white; }
    #spinBtn:hover:not(:disabled) { background: #0056b3; }
    
    #resetBtn { background: #6c757d; color: white; }
    #resetBtn:hover { background: #5a6268; }

    button:disabled {
      background: #ccc;
      cursor: not-allowed;
    }
  </style>
</head>
<body>
  <h1>ğŸ´ ä»Šå¤©åƒä»€éº¼ï¼Ÿ</h1>

  <div class="container">
    <div class="wheel-outer">
      <div class="pointer"></div>
      <canvas id="wheel"></canvas>
    </div>

    <div class="input-box">
      <label><strong>è«‹è¼¸å…¥èœå–®ï¼ˆä¸€åˆ—ä¸€å€‹ï¼‰</strong></label>
      <textarea id="foodInput" placeholder="å£½å¸&#10;æ»·è‚‰é£¯&#10;ç‰›è‚‰éºµ&#10;éº¥ç•¶å‹"></textarea>
      
      <label style="display:flex; align-items:center; gap:6px; font-size:14px; cursor:pointer;">
        <input type="checkbox" id="removeAfterSpin"> æŠ½åˆ°å¾Œå¾æ¸…å–®åˆªé™¤
      </label>

      <div class="btn-group">
        <button id="resetBtn">æ¸…ç©º</button>
        <button id="spinBtn">ğŸ”¥ é–‹å§‹æŠ½ç±¤</button>
      </div>
    </div>
  </div>

  <script>
    const canvas = document.getElementById('wheel');
    const ctx = canvas.getContext('2d');
    const spinBtn = document.getElementById('spinBtn');
    const resetBtn = document.getElementById('resetBtn');
    const foodInput = document.getElementById('foodInput');

    canvas.width = canvas.height = 800;
    let currentRotation = 0;
    let isSpinning = false;

    // ç¹ªè£½è½‰ç›¤é‚è¼¯
    function drawWheel() {
      const items = foodInput.value.split('\n').filter(i => i.trim() !== '');
      const num = items.length;
      
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      
      if (num === 0) {
          // è‹¥æ²’è³‡æ–™ï¼Œç•«ä¸€å€‹ç°è‰²çš„ç©ºåœ“
          ctx.beginPath();
          ctx.arc(400, 400, 390, 0, 2 * Math.PI);
          ctx.fillStyle = "#eee";
          ctx.fill();
          return;
      }

      const arcSize = (2 * Math.PI) / num;
      const colors = ['#FF6B6B', '#4ECDC4', '#FFE66D', '#1A535C', '#A29BFE', '#FF9F1C', '#95A5A6', '#F8A5C2'];

      ctx.save();
      ctx.translate(400, 400);
      ctx.rotate(-Math.PI / 2); // è®“ç¬¬ä¸€å€‹é¸é …å°æº–ä¸Šæ–¹æŒ‡é‡
      ctx.translate(-400, -400);

      items.forEach((text, i) => {
        const angle = i * arcSize;
        ctx.beginPath();
        ctx.fillStyle = colors[i % colors.length];
        ctx.moveTo(400, 400);
        ctx.arc(400, 400, 390, angle, angle + arcSize);
        ctx.fill();
        ctx.strokeStyle = "rgba(255,255,255,0.4)";
        ctx.lineWidth = 2;
        ctx.stroke();

        ctx.save();
        ctx.translate(400, 400);
        ctx.rotate(angle + arcSize / 2);
        ctx.textAlign = 'right';
        ctx.fillStyle = (colors[i % colors.length] === '#1A535C') ? 'white' : '#333';
        ctx.font = 'bold 32px Microsoft JhengHei';
        ctx.fillText(text.substring(0, 10), 350, 12); // é™åˆ¶é•·åº¦é¿å…æº¢å‡º
        ctx.restore();
      });
      ctx.restore();
    }

    foodInput.addEventListener('input', drawWheel);
    resetBtn.addEventListener('click', () => {
        foodInput.value = "";
        drawWheel();
    });
    
    // åˆå§‹ç¹ªè£½
    drawWheel();

    spinBtn.addEventListener('click', () => {
      if (isSpinning) return;

      const items = foodInput.value.split('\n').filter(i => i.trim() !== '');
      if (items.length < 2) {
        alert('è«‹è‡³å°‘è¼¸å…¥å…©å€‹é¸é …æ‰èƒ½æŠ½ç±¤å–”ï¼');
        return;
      }

      isSpinning = true;
      spinBtn.disabled = true;

      const baseSpins = 5; // åŸºæœ¬è½‰5åœˆ
      const randomExtra = Math.floor(Math.random() * 360); 
      const totalRotation = currentRotation + (360 * baseSpins) + randomExtra;

      canvas.style.transform = `rotate(${totalRotation}deg)`;
      currentRotation = totalRotation;

      setTimeout(() => {
        isSpinning = false;
        spinBtn.disabled = false;

        const actualDeg = currentRotation % 360;
        const num = items.length;
        const arcSizeDeg = 360 / num;

        // è¨ˆç®—ä¸­çç´¢å¼•
        let winningIndex = Math.floor((360 - actualDeg) % 360 / arcSizeDeg);

        alert(`ğŸ‰ ä»Šå¤©å°±åƒï¼š${items[winningIndex]}ï¼`);

        if (document.getElementById('removeAfterSpin').checked) {
          items.splice(winningIndex, 1);
          foodInput.value = items.join("\n");
          
          // ç§»é™¤ä¸­çé …å¾Œï¼Œç¬é–“é‡ç½®è½‰ç›¤ä½ç½®ï¼Œé¿å…ä¸‹æ¬¡æ—‹è½‰è¨ˆç®—éŒ¯èª¤
          canvas.style.transition = 'none';
          currentRotation = 0;
          canvas.style.transform = `rotate(0deg)`;
          drawWheel();
          setTimeout(() => { 
              canvas.style.transition = 'transform 4s cubic-bezier(0.15, 0, 0.15, 1)'; 
          }, 50);
        }
      }, 4000);
    });
  </script>
</body>
</html>
</body>
</html>
