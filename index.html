<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>å“‡ã„Ÿç¶²ç«™</title>
    <link rel="icon"href="icon.png">
  </head>
  <body>
  <!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ä»Šå¤©åƒä»€éº¼è½‰ç›¤</title>
  <style>
    body {
      font-family: 'Microsoft JhengHei', sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      background: #f0f2f5;
    }

    .container {
      display: flex;
      gap: 50px;
      align-items: center;
      margin-top: 30px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .wheel-outer {
      position: relative;
      width: 400px;
      height: 400px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      border-radius: 50%;
    }

    .pointer {
      width: 0;
      height: 0;
      border-left: 15px solid transparent;
      border-right: 15px solid transparent;
      border-top: 30px solid #e74c3c;
      position: absolute;
      top: -15px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 10;
      filter: drop-shadow(0 2px 2px rgba(0,0,0,0.2));
    }

    canvas {
      transition: transform 4s cubic-bezier(0.15, 0, 0.15, 1);
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background: white;
    }

    .input-box {
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      display: flex;
      flex-direction: column;
      gap: 15px;
      width: 300px;
    }

    textarea {
      height: 180px;
      padding: 12px;
      border-radius: 8px;
      border: 1px solid #ddd;
      line-height: 1.6;
      font-size: 16px;
    }

    button {
      padding: 12px;
      border-radius: 8px;
      border: none;
      background: #007bff;
      color: white;
      font-weight: bold;
      font-size: 18px;
      cursor: pointer;
      transition: 0.3s;
    }

    button:disabled {
      background: #ccc;
      cursor: not-allowed;
    }

    button:hover:not(:disabled) {
      background: #0056b3;
    }
  </style>
</head>
<body>
  <h1>ğŸ´ ä»Šå¤©åƒä»€éº¼ï¼Ÿ</h1>

  <div class="container">
    <div class="wheel-outer">
      <div class="pointer"></div>
      <canvas id="wheel"></canvas>
    </div>

    <div class="input-box">
      <label><strong>è«‹è¼¸å…¥èœå–®ï¼ˆä¸€åˆ—ä¸€å€‹ï¼‰</strong></label>
      <textarea id="foodInput" placeholder="å£½å¸&#10;æ»·è‚‰é£¯&#10;ç‰›è‚‰éºµ&#10;éº¥ç•¶å‹"></textarea>
      <label style="display:flex; align-items:center; gap:6px; font-size:14px;">
        <input type="checkbox" id="removeAfterSpin"> æŠ½åˆ°å¾Œåˆªé™¤æ­¤é …ç›®
      </label>
      <button id="spinBtn">ğŸ”¥ é–‹å§‹æŠ½ç±¤</button>
    </div>
  </div>

  <script>
    const canvas = document.getElementById('wheel');
    const ctx = canvas.getContext('2d');
    const spinBtn = document.getElementById('spinBtn');
    const foodInput = document.getElementById('foodInput');

    canvas.width = canvas.height = 800;
    let currentRotation = 0;
    let isSpinning = false;

    // è‡ªå‹•è®€å–ä¸Šæ¬¡çš„é¸å–®
    window.onload = () => {
      const savedData = localStorage.getItem('myMenu');
      if (savedData) {
        foodInput.value = savedData;
        drawWheel();
      }
    };

    function drawWheel() {
      const items = foodInput.value.split('\n').filter(i => i.trim() !== '');
      if (items.length === 0) return;
      
      localStorage.setItem('myMenu', foodInput.value);

      const num = items.length;
      const arcSize = (2 * Math.PI) / num;
      const colors = ['#FF6B6B', '#4ECDC4', '#FFE66D', '#1A535C', '#A29BFE', '#FF9F1C', '#95A5A6', '#F8A5C2'];

      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.save();
      ctx.translate(400, 400);
      ctx.rotate(-Math.PI / 2);
      ctx.translate(-400, -400);

      items.forEach((text, i) => {
        const angle = i * arcSize;
        ctx.beginPath();
        ctx.fillStyle = colors[i % colors.length];
        ctx.moveTo(400, 400);
        ctx.arc(400, 400, 390, angle, angle + arcSize);
        ctx.fill();
        ctx.strokeStyle = 'rgba(255,255,255,0.5)';
        ctx.lineWidth = 2;
        ctx.stroke();

        ctx.save();
        ctx.translate(400, 400);
        ctx.rotate(angle + arcSize / 2);
        ctx.textAlign = 'right';
        ctx.fillStyle = (colors[i % colors.length] === '#1A535C') ? 'white' : '#333';
        ctx.font = 'bold 32px Microsoft JhengHei';
        ctx.fillText(text, 350, 10);
        ctx.restore();
      });
      ctx.restore();
    }

    foodInput.addEventListener('input', drawWheel);
    drawWheel();

    spinBtn.addEventListener('click', () => {
      if (isSpinning) return;

      const items = foodInput.value.split('\n').filter(i => i.trim() !== '');
      if (items.length < 2) {
        alert('è«‹è‡³å°‘è¼¸å…¥å…©å€‹é¸é …ï¼');
        return;
      }

      isSpinning = true;
      spinBtn.disabled = true;

      const randomExtra = Math.floor(Math.random() * 360) + Math.floor(Math.random() * 720);
      const baseSpins = Math.floor(Math.random() * 4) + 4;
      const totalRotation = currentRotation + (360 * baseSpins) + randomExtra;

      canvas.style.transform = `rotate(${totalRotation}deg)`;
      currentRotation = totalRotation;

      setTimeout(() => {
        isSpinning = false;
        spinBtn.disabled = false;

        const actualDeg = currentRotation % 360;
        const num = items.length;
        const arcSizeDeg = 360 / num;
        let winningIndex = Math.floor((360 - actualDeg) % 360 / arcSizeDeg);

        alert(`ğŸ‰ ä»Šå¤©å°±åƒï¼š${items[winningIndex]}ï¼`);

        const remove = document.getElementById('removeAfterSpin').checked;
        if (remove) {
          items.splice(winningIndex, 1);
          foodInput.value = items.join('\n');
          canvas.style.transition = 'none';
          currentRotation = 0;
          canvas.style.transform = `rotate(0deg)`;
          drawWheel();
          setTimeout(() => { canvas.style.transition = 'transform 4s cubic-bezier(0.15, 0, 0.15, 1)'; }, 50);
        }
      }, 4000);
    });
  </script>
</body>
</html>

  </body>
</html>
